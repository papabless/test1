/** Credits
 * @desc Sweepabit.com core source file
 * @author Dexon <dexon@live.ca> (https://github.com/Dexon95)
 * @contributors uniibu (https://github.com/uniibu)
 */

/**
 * @version Official source (https://github.com/Dexon95/bitsweeper)
 */
function setBet(e){game.bet=parseFloat(parseFloat(e).toFixed(2)),betSave=game.bet,"undefined"!=$.cookie("gameBet")&&$.removeCookie("gameBet"),$.cookie("gameBet",betSave)}function setBombs(e){game.bombs=Math.floor(parseFloat(e)),"undefined"!=$.cookie("gameBombs")&&$.removeCookie("gameBombs"),$.cookie("gameBombs",game.bombs)}function setClientSeed(e){game.clientSeed=parseFloat(e),"undefined"!=$.cookie("clientSeed")&&$.removeCookie("clientSeed"),$.cookie("clientSeed",game.clientSeed)}function getURLParameter(e){return decodeURIComponent((new RegExp("[#|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.hash)||[,""])[1].replace(/\+/g,"%20"))||null}function onkeyup_check(e){13==e.keyCode&&sendMessage(document.getElementById("chatText").value)}function sendMessage(e){document.getElementById("chatText").value="",socket.emit("new_message",{text:e},function(e,t){return e?void console.log("Error when submitting new_message to server:",e):void console.log("Successfully submitted message:",t)})}function ObjectLength(e){var t=0;for(var o in e)e.hasOwnProperty(o)&&++t;return t}function addNewChatMessage(e){if("undefined"!=typeof e.user&&"undefined"!=typeof e.channel)var t=escapeHTML(e.user.uname),o=e.user.role;else var t="Server",o="server";var a={hours:addZero(new Date(e.created_at).getHours()),mins:addZero(new Date(e.created_at).getMinutes())},s=escapeHTML(e.text);s=stripCombiningMarks(s);var n=!1;""!=$("#username").text()&&s.indexOf("@"+$("#username").text())>-1&&(t!=$("#username").text()&&(n=!0),s=s.replace("@"+$("#username").text(),"<span class='notify'>@"+$("#username").text()+"</span>"));var i=document.getElementById("chatMonitor"),l="Server"==t?"style='color:lime;font-weight:bold;'":"",c="OWNER"==o?"style='color:#E74C3C;":"ADMIN"==o?"style='color:#EC87C0;":"MOD"==o?"style='color:#2ECC71;":"style='";isInHighRollersList(t)&&(c+='background:url("lib/css/img/sparkle.gif");'),c+="'",i.innerHTML+='<span class="chatMessage '+(n?"notify":"")+'" '+l+"><small>"+a.hours+":"+a.mins+"</small> <b "+c+">"+t+"</b>: "+urlify(s)+"<br></span>",i.scrollTop=i.scrollHeight;var r=document.getElementsByClassName("chatMessage");r.length>120&&i.removeChild(r[0]),$(".safeLink").click(function(){var e=$(this).text();$("#unknownLink").text(e),$(".safeLinkDoRedirectButton").attr("href",e),$("#safeLinkForm").modal("setting","closable",!1).modal("show"),$("#safeLinkCancelRedirectButton").click(function(){$("#safeLinkForm").modal("hide")})})}function addZero(e){return 10>e&&(e="0"+e),e}function onloadCallback(){grecaptcha.render("faucetClaimCaptcha",{sitekey:"6LcFXR8TAAAAAL0DIqGJBNhrtul2kwY-Z6lUhEjm",callback:correctCaptcha})}function correctCaptcha(e){$.ajax({type:"POST",contentType:"application/json",url:"https://api.moneypot.com/v1/claim-faucet?access_token="+access_token,data:JSON.stringify({response:e}),dataType:"json"}).done(function(e){console.log(e.amount/100+" has been added to your balance!"),$.get("https://api.moneypot.com/v1/auth?access_token="+access_token,function(e){"undefined"!=typeof e.user.uname&&(user_balance=e.user.balance/100,$("#balance").text(user_balance.formatMoney(2,".",",")))}),$("#faucetClaimCaptcha").css("top","-90px"),grecaptcha.reset(),showingrecaptcha=!1,claimedTime=(new Date).getTime(),faucetTimer=setInterval(function(){return parseInt(claimedTime)+3e5<=(new Date).getTime()?($("#faucetButton").removeClass("claimed"),clearInterval(faucetTimer),claimedTime=!1,$("#faucetButton").attr("disabled",!1),void $("#faucetButton").text("FAUCET")):($("#faucetButton").attr("disabled",!0),$("#faucetButton").addClass("claimed"),void $("#faucetButton").text(parseFloat(300-((new Date).getTime()-claimedTime)/1e3).formatMoney(2,".",",")))},100),"undefined"!=$.cookie("faucetClaim")&&$.removeCookie("faucetClaim"),$.cookie("faucetClaim",claimedTime)}).fail(function(e){var t=e.error;"FAUCET_ALREADY_CLAIMED"==t?(console.error("Faucet already claimed"),grecaptcha.reset()):"INVALID_INPUT_RESPONSE"==t&&(console.error("Google has rejected the response. Try to refresh and do again."),grecaptcha.reset()),$("#faucetClaimCaptcha").css("top","-90px"),showingrecaptcha=!1})}function startNewGame(){return connected?($("#loaderContainer").css("display","block"),$("#loaderText").text("Getting new Hash for provably fair"),$(".settingsButon").css("display","none"),void $.post("https://api.moneypot.com/v1/hashes?access_token="+access_token,"",function(e){if(console.log("[Provably fair] We received our hash: "+e.hash),Hash="undefined"==typeof e.hash?!1:e.hash,$("#loaderContainer").css("display","none"),""==Hash||0==Hash)return $("#theDimmer").html('Error: Not connected!<br><a href="https://www.moneypot.com/oauth/authorize?app_id=1115&response_type=token&state=Meh&redirect_uri=http://bitmine.xyz">Click here to login</a>'),$("#game_left").dimmer("show"),void $(".settingsButon").css("display","inline-block");if(game.bombs<1||game.bombs>24)return $("#theDimmer").html("Error: Bombs amount!<br>(min 1 & max 24)"),$("#game_left").dimmer("show"),void $(".settingsButon").css("display","inline-block");if(game.tilesClicked=0,houseEdge=.01,odds=(25-game.bombs-game.tilesClicked)/(25-game.tilesClicked),next=game.bet*((1-houseEdge)/odds)-game.bet,game={status:"IN_PROGRESS",profit:0,bet:game.bet,bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:odds,next:next,stake:game.bet},user_balance-game.bet<0)return $("#theDimmer").html("Error: Not enough Balance!"),$("#game_left").dimmer("show"),game={status:"ENDED",profit:game.stake,bet:parseFloat($("#bet").val()),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},void $(".settingsButon").css("display","inline-block");if(game.bet<0)return $("#theDimmer").html("Error: Invalid bet amount!"),$("#game_left").dimmer("show"),game={status:"ENDED",profit:game.stake,bet:parseFloat($("#bet").val()),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},void $(".settingsButon").css("display","inline-block");$("#cashoutButton").css("display","inline-block"),$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),boardHtml=$("#board").html(),$("#board").html("");for(var t=0;25>t;t++)$("#board").append("<li data-tile='"+t+"' class='tile'></li>");$(".tile").each(function(e){$(this).click(function(){if("IN_PROGRESS"==game.status){var t=!1;if($(".tile").each(function(e){$(this).hasClass("tileLoading")&&(t=!0)}),!t){user_balance-=game.stake,$("#balance").text(user_balance.formatMoney(2,".",",")),parseInt($(this).attr("data-tile")),$(this).addClass("tileLoading"),$(this).html('<div class="ui active loader"></div>');var o=100*game.stake;console.log("[BET] Game:",game);var a=Math.floor(Math.pow(2,32)*game.odds);game.tilesClicked++;var s=$(this);$.ajax({type:"POST",contentType:"application/json",url:"https://api.moneypot.com/v1/bets/custom?access_token="+access_token,data:JSON.stringify({client_seed:parseInt(game.clientSeed),hash:String(Hash),wager:o,payouts:[{from:0,to:a,value:100*(game.stake+game.next)},{from:a,to:Math.pow(2,32),value:0}]}),dataType:"json",error:function(e,t,o){console.error("[BET ERROR]",e.responseText)}}).done(function(t){if(s.removeClass("tileLoading"),console.log("[BET RESULT]",t),t.next_hash)if(console.log("[Provably fair] new hash: "+t.next_hash),Hash=t.next_hash,t.outcome>=a){if(s.addClass("pressed"),s.addClass("bomb reveal"),s.html('<i class="icon-alert warning icon"></i>'),$("#logs").html('<div class="log_item" style="border-left: 4px solid #E74C3C;">Clicked tile #'+e+'<br>Found: <span style="color: #E74C3C">Bomb</span>! <button id="playAgainButton">Play Again</button><div class="info"><a href="https://www.moneypot.com/bets/'+t.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#logs").html()),$("#playAgainButton").click(function(){$("#playAgainButton").remove(),$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet)}),game.bombs>1)for(var o=0;o<game.bombs-1;o++){var n=[];$(".tile").each(function(e){$(this).hasClass("pressed")||$(this).hasClass("reveal")||n.push(e)}),roll=Math.floor(Math.random()*n.length)+1,$(".tile:eq("+n[roll-1]+")").addClass("reveal").html('<i class="icon-alert warning icon"></i>')}$("#cashoutButton").css("display","none"),game={status:"ENDED",profit:0-parseFloat($("#bet").val()),bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game),$(".settingsButon").css("display","inline-block")}else s.addClass("pressed"),s.html('<span class="tile_val">+'+parseFloat(game.next).formatMoney(2,".",",")+"</span>"),$("#logs").html('<div class="log_item" style="border-left: 4px solid #8D4;">Clicked tile #'+e+'<br>Found: <span style="color: #8D4">'+parseFloat(game.next).formatMoney(2,".",",")+'</span> Bits!<div class="info"><a href="https://www.moneypot.com/bets/'+t.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#logs").html()),user_balance+=game.next+game.stake,$("#balance").text(user_balance.formatMoney(2,".",",")),houseEdge=.005,odds=(25-game.bombs-game.tilesClicked)/(25-game.tilesClicked),next=(game.bet+game.next)*((1-houseEdge)/odds)-(game.bet+game.next),game={status:"IN_PROGRESS",profit:0,bet:game.bet+game.next,bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:game.tilesClicked,odds:odds,next:next,stake:game.bet+game.next},$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game);else console.log("BET ERROR: "+JSON.stringify(t.responseJSON)),$(".settingsButon").css("display","inline-block")})}}})}),console.log("~~ New game ~~\n",game),$("#game_log").css("display","inline-block"),$("#highRoller_log").css("top","480px"),$(this).css("display","inline-block")},"json")):($("#theDimmer").html('Error: Not connected!<br><a href="https://www.moneypot.com/oauth/authorize?app_id=1115&response_type=token&state=Meh&redirect_uri=http://bitmine.xyz">Click here to login</a>'),void $("#game_left").dimmer("show"))}function showSettings(){$("#theDimmer").html('<label style="color:white;">Bet:</label><input class="bet" type="number" pattern="[0-9]*" value="'+betSave+'" onkeyup="setBet($(this).val());" onchange="setBet($(this).val());" style="color:black;width:150px;"><br><label style="color:white;">Bombs:</label><input class="bet" type="number" pattern="[0-9]*" value="'+game.bombs+'" onkeyup="setBombs($(this).val());" onchange="setBombs($(this).val());" style="color:black;width:150px;"><br><label style="color:white;">Client Seed:</label><input class="bet" type="number" pattern="[0-9]*" value="'+game.clientSeed+'" onkeyup="setClientSeed($(this).val());" onchange="setClientSeed($(this).val());" style="color:black;width:150px;">'),$("#game_left").dimmer("show")}function escapeHTML(e){e+="";for(var t="",o=0;o<e.length;o++)t+="<"===e[o]?"&lt;":">"===e[o]?"&gt;":"'"===e[o]?"&#39;":'"'===e[o]?"&#34;":"%"===e[o]?"&#37;":"\\"===e[o]?"&#92;":"¢"===e[o]?"&#162;":"¼"===e[o]?"&#188;":"½"===e[o]?"&#189;":"¾"===e[o]?"&#190;":"#"===e[o]?"&#35;":"&"===e[o]&&"#"===e[o+1]?"&#38;":e[o];return t}function urlify(e){var t=/(https?:\/\/[^\s]+)/g;return e.replace(t,function(e){return'<a class="safeLink">'+e+"</a>"})}function isInHighRollersList(e){var t=!1;return $(".hr_log_item_username").each(function(){$(this).text()==e&&(t=!0)}),t}function getRandCseed(){var e=new Uint32Array(1);return window.crypto.getRandomValues(e)[0]}var socket,users=0,Hash="",showingrecaptcha=!1,boardHtml="",user_balance=0,claimedTime=!1,faucetTimer,access_token=null,currentSafeLink="";if("undefined"==typeof $.cookie("faucetClaim")?(claimedTime=!1,$.cookie("faucetClaim",claimedTime)):(claimedTime=parseInt($.cookie("faucetClaim")),claimedTime&&claimedTime>0&&(faucetTimer=setInterval(function(){return parseInt(claimedTime)+3e5<=(new Date).getTime()?($("#faucetButton").removeClass("claimed"),clearInterval(faucetTimer),claimedTime=!1,$("#faucetButton").attr("disabled",!1),$("#faucetButton").text("FAUCET"),"undefined"!=$.cookie("faucetClaim")&&$.removeCookie("faucetClaim"),void $.cookie("faucetClaim",claimedTime)):($("#faucetButton").attr("disabled",!0),$("#faucetButton").addClass("claimed"),void $("#faucetButton").text(parseFloat(300-((new Date).getTime()-claimedTime)/1e3).formatMoney(2,".",",")))},100))),"undefined"==typeof $.cookie("gameBet")){var betSave=2;$.cookie("gameBet",betSave)}else var betSave=$.cookie("gameBet");if("undefined"==typeof $.cookie("gameBombs")){var gameBombs=3;$.cookie("gameBombs",gameBombs)}else var gameBombs=$.cookie("gameBombs");var connected=!1;if("undefined"==typeof $.cookie("clientSeed")){var clientSeed=getRandCseed();$.cookie("clientSeed",clientSeed)}else var clientSeed=$.cookie("clientSeed");var game={status:"?",profit:0,bet:parseFloat(betSave),bombs:parseInt(gameBombs),clientSeed:clientSeed,tilesClicked:0,odds:0,next:0,stake:0};$("#bet").val(game.bet),$("#bombsButtons .button").each(function(e){1==game.bombs?0===e?$(this).addClass("active"):$(this).removeClass("active"):3==game.bombs?1===e?$(this).addClass("active"):$(this).removeClass("active"):5==game.bombs?2===e?$(this).addClass("active"):$(this).removeClass("active"):24==game.bombs?3===e?$(this).addClass("active"):$(this).removeClass("active"):4===e?($(this).addClass("active"),$("#customBombs").val(game.bombs),$("#customBombsInputArea").css("display","inline-flex")):$(this).removeClass("active")}),$(function(){var e=jQuery("<div/>",{id:"loaderContainer",style:"position: absolute;top: 0; right: 0; bottom: 0; left: 0;z-index: 2000;"}).appendTo("body"),t=jQuery("<div/>",{"class":"ui segment",style:"height: 100%; opacity: 0.7;"}).appendTo(e),o=jQuery("<div/>",{"class":"ui active dimmer"}).appendTo(t);jQuery("<div/>",{id:"loaderText","class":"ui text loader",text:"Connecting"}).appendTo(o),"undefined"!=typeof $.session.get("session_access_token")&&(access_token=$.session.get("session_access_token")),""!=getURLParameter("access_token")&&null!=getURLParameter("access_token")&&(access_token=getURLParameter("access_token"),"undefined"!=typeof $.session.get("session_access_token")&&$.session.remove("session_access_token"),$.session.set("session_access_token",access_token),window.history.pushState("","BitMine","/")),socket=io("https://socket.moneypot.com");var a={app_id:1115,access_token:""!=access_token&&null!=access_token?access_token:void 0,subscriptions:["CHAT","DEPOSITS","BETS"]};socket.on("connect",function(){console.info("[socketpot] connected");var e={app_id:a.app_id,access_token:a.access_token,subscriptions:a.subscriptions};socket.emit("auth",e,function(e,t){if(e)return $("#loaderContainer").css("display","block"),$("#loaderText").text("Error while connecting: "+e),void console.error("[auth] Error:",e);var o=t;$("#loaderContainer").css("display","none"),""!=access_token&&null!=access_token&&($("#connectButton").css("display","none"),jQuery("<input/>",{id:"chatText",type:"text",maxlength:"200",placeholder:"Chat here"}).appendTo("#chat"),jQuery("<button/>",{id:"chatButton",text:"Send"}).appendTo("#chat"),$("#chatText").keyup(function(e){onkeyup_check(e)}),$("#chatButton").click(function(){sendMessage(String(document.getElementById("chatText").value))}),$.getJSON("https://api.moneypot.com/v1/token?access_token="+access_token,function(e){$("#connectionText").css("display","block"),$("#betPanel").css("display","block"),$("#depositButton").css("display","inline-block"),$("#withdrawButton").css("display","inline-block"),$("#username").text(e.auth.user.uname),$("#balance").text((e.auth.user.balance/100).formatMoney(2,".",",")),user_balance=e.auth.user.balance/100,connected=!0,$("#highRoller_log").css("display","block"),$("#highRoller_logs").html('<div class="ui active loader"></div>'),$(".chatMessage").each(function(e){$(this).html().split(":")[1],$(this).html($(this).html().replace("@"+$("#username").text(),"<span class='notify'>@"+$("#username").text()+"</span>"))})}),$.getJSON("https://api.moneypot.com/v1/list-bets?access_token="+access_token+"&app_id=1115&wager=500000&limit=13&order_by=desc",function(e){$("#highRoller_logs").html(""),e.length>0&&$.each(e.reverse(),function(t){e[t].profit<=0?$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #E74C3C;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e[t].uname+'">'+e[t].uname+'</a></b>: <span style="color: #E74C3C">'+parseFloat(e[t].wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e[t].id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()):$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #8D4;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e[t].uname+'">'+e[t].uname+'</a></b>: <span style="color: #8D4">'+parseFloat(e[t].wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e[t].id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()),$(".hr_log_item").each(function(e){e>10&&$(this).remove()})})}),console.log(o)),users=ObjectLength(o.chat.userlist),$("#connectedUsersAmount").text(users);for(var a=0;a<o.chat.messages.length;a++)addNewChatMessage(o.chat.messages[a]);var s=document.getElementById("chatMonitor");s.innerHTML+='<span class="chatMessage"><div style="border-top:1px solid rgba(241,196,15,0.3);border-bottom:1px solid rgba(241,196,15,0.3);background-color:rgba(241,196,15,0.2);"><span style="color: #F1C40F;font-weight:bold;">Warning:</span> Never give your access_token to anyone or run unknown scripts. This may compromise your wallet security.</div><br></span>',s.scrollTop=s.scrollHeight,$(".safeLink").click(function(){var e=$(this).text();$("#unknownLink").text(e),$(".safeLinkDoRedirectButton").attr("href",e),$("#safeLinkForm").modal("setting","closable",!1).modal("show"),$("#safeLinkCancelRedirectButton").click(function(){$("#safeLinkForm").modal("hide")})})})}),socket.on("disconnect",function(){console.warn("[socketpot] disconnected"),document.getElementById("chatMonitor").innerHTML="",connected=!1}),socket.on("client_error",function(e){console.error("[socketpot] client_error:",e)}),socket.on("error",function(e){console.error("[socketpot] error:",e)}),socket.on("reconnect_error",function(e){console.error("[socketpot] error while reconnecting:",e),console.info("If this message keeps coming back, try to clear cache then close and reopen your browser."),$("#loaderContainer").css("display","block"),$("#loaderText").text("Error while reconnecting! If this message keeps coming back, try to clear cache then close and reopen your browser."),connected=!1}),socket.on("reconnecting",function(){console.warn("[socketpot] attempting to reconnect..."),console.info("If this message keeps coming back, try to clear cache then close and reopen your browser."),$("#loaderContainer").css("display","block"),$("#loaderText").text("Reconnecting"),connected=!1}),socket.on("reconnect",function(){console.info("[socketpot] successfully reconnected"),$("#loaderContainer").css("display","none"),connected=!0}),socket.on("user_joined",function(e){users++,$("#connectedUsersAmount").text(users),console.log(e.uname+" joined the chat. ("+users+" users online)")}),socket.on("user_left",function(e){users--,$("#connectedUsersAmount").text(users),console.log(e.uname+" left the chat. ("+users+" users online)")}),socket.on("new_message",function(e){addNewChatMessage(e)}),socket.on("new_bet",function(e){if($("#username").text()==e.uname){var t=document.getElementById("game_mybets_logs"),o=t.insertRow(0);o.id="mybet_"+e.id,o.className="mybets_log_item";var a=o.insertCell(0),s=o.insertCell(1),n=o.insertCell(2),i=parseFloat(e.profit)>=0;a.innerHTML='<a href="https://www.moneypot.com/bets/'+e.id+'" target="blank">'+e.id+"</a>",a.className=i?"win":"lose",s.innerHTML=parseFloat(parseFloat(e.wager/100).toFixed(2))+" Bits",n.innerHTML=i?'<span style="color: #8D4">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits":'<span style="color: #E74C3C">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits",e.wager/100>=1e5&&(e.profit<=0?$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #E74C3C;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+'</a></b>: <span style="color: #E74C3C">'+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()):$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #8D4;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+'</a></b>: <span style="color: #8D4">'+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()),$(".hr_log_item").each(function(e){e>10&&$(this).remove()})),$(".mybets_log_item").each(function(e){e>8&&$(this).remove()})}var t=document.getElementById("game_allbets_logs"),o=t.insertRow(0);o.id="bet_"+e.id,o.className="allbets_log_item";var a=o.insertCell(0),s=o.insertCell(1),n=o.insertCell(2),i=parseFloat(e.profit)>=0;a.innerHTML='<a href="https://www.moneypot.com/bets/'+e.id+'" target="blank">'+e.id+"</a>",a.className=i?"win":"lose",s.innerHTML='<a href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+"</a>",n.innerHTML=i?'<span style="color: #8D4">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits":'<span style="color: #E74C3C">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits",e.wager/100>=1e5&&(e.profit<=0?$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #E74C3C;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+'</a></b>: <span style="color: #E74C3C">'+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()):$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #8D4;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+'</a></b>: <span style="color: #8D4">'+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()),$(".hr_log_item").each(function(e){e>10&&$(this).remove()})),$(".allbets_log_item").each(function(e){e>8&&$(this).remove()})}),socket.on("balance_change",function(e){$("#balance").text((e.balance/100).formatMoney(2,".",",")),user_balance=e.balance/100})}),Number.prototype.formatMoney=function(e,t,o){var a=this,e=isNaN(e=Math.abs(e))?2:e,t=void 0==t?".":t,o=void 0==o?",":o,s=0>a?"-":"",n=parseInt(a=Math.abs(+a||0).toFixed(e))+"",i=(i=n.length)>3?i%3:0;return s+(i?n.substr(0,i)+o:"")+n.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+o)+(e?t+Math.abs(a-n).toFixed(e).slice(2):"")},$("#depositButton").click(function(){$.get("https://api.moneypot.com/v1/deposit-address?access_token="+access_token,function(e){$("#depositForm").modal("setting","closable",!1).modal("show"),"undefined"!=typeof e.deposit_address?$("#depositBtcAddy").text(e.deposit_address):$("#depositBtcAddy").text("Couldn't request a deposit addy. Please, use moneypot.")})}),$("#tipButton").click(function(){$("#tippingForm").modal("setting","closable",!1).modal("show")}),$("#sendTipButton").click(function(){$("#sendTipButton").addClass("loading"),$("#sendTipButton").attr("disabled",!0);var e=$("#tipping_username_input").val(),t=$("#tipping_amount_input").val(),o=confirm("Are you sure to tip "+t+" Bits to "+e+" ?");1==o&&t==parseFloat(t)&&$.ajax({type:"POST",contentType:"application/json",url:"https://api.moneypot.com/v1/tip?access_token="+access_token,data:JSON.stringify({uname:e,amount:Math.floor(100*t)}),dataType:"json",error:function(t,o,a){console.error("[TIP ERROR]",t.responseText),addNewChatMessage({created_at:(new Date).getTime().toISOString(),text:"Error when sending tip to "+e+": "+t.responseText.error})}}).done(function(o){o.id?(addNewChatMessage({created_at:(new Date).toISOString(),text:"Sent "+t+" Bits to "+e}),user_balance-=t,$("#balance").text(user_balance.formatMoney(2,".",","))):addNewChatMessage({created_at:(new Date).getTime().toISOString(),text:"Error when sending tip to "+e+": "+o}),$("#tippingForm").modal("hide"),$("#sendTipButton").removeClass("loading"),$("#sendTipButton").attr("disabled",!1),$("#tipping_username_input").val(""),$("#tipping_amount_input").val("")})}),$("#moneypotDepositButton").click(function(){var e="https://www.moneypot.com/dialog/deposit?app_id=1115",t="manage-auth",o="width=420,height=350,left=100,top=100",a=window.open(e,t,o);a.focus()}),$("#withdrawButton").click(function(){var e="https://www.moneypot.com/dialog/withdraw?app_id=1115",t="manage-auth",o="width=420,height=350,left=100,top=100",a=window.open(e,t,o);a.focus()}),$("#faucetButton").click(function(){0==showingrecaptcha?($("#faucetClaimCaptcha").css("top","10px"),showingrecaptcha=!0,console.log("showing google recaptcha")):1==showingrecaptcha&&($("#faucetClaimCaptcha").css("top","-90px"),showingrecaptcha=!1,console.log("hiding google recaptcha"))}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})});var houseEdge,odds,next;$("#startNewGameButton").click(function(){startNewGame()}),$("#cashoutButton").click(function(){var e=!1;if($(".tile").each(function(t){$(this).hasClass("tileLoading")&&(e=!0)}),!e){$(this).css("display","none"),$("#logs").html('<div class="log_item" style="border-left: 4px solid #F39C12;">Cashed out!<br>Profit: <span style="color: #F39C12">'+parseFloat(game.stake).formatMoney(2,".",",")+'</span> Bits! <button id="playAgainButton">Play Again</button></div>'+$("#logs").html()),$("#playAgainButton").click(function(){$("#playAgainButton").remove(),$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet)});for(var t=0;t<game.bombs;t++){var o=[];$(".tile").each(function(e){$(this).hasClass("pressed")||$(this).hasClass("reveal")||o.push(e)}),roll=Math.floor(Math.random()*o.length)+1,$(".tile:eq("+o[roll-1]+")").addClass("reveal").html('<i class="icon-alert warning icon"></i>')}$("#cashoutButton").css("display","none"),game={status:"ENDED",profit:0-parseFloat($("#bet").val()),bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game),$(".settingsButon").css("display","inline-block")}}),$(document).keypress(function(e){if(32==e.which&&$("input:focus").length<=0)if("IN_PROGRESS"==game.status)$("#cashoutButton").css("display","none"),$("#logs").html('<div class="log_item" style="border-left: 4px solid #F39C12;">Cashed out!<br>Profit: <span style="color: #F39C12">'+parseFloat(game.stake).formatMoney(2,".",",")+"</span> Bits!</div>"+$("#logs").html()),$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED_AWAITING",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet),$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game),$(".settingsButon").css("display","inline-block");else{if("?"==game.status||"ENDED_AWAITING"==game.status)return void startNewGame();$("#playAgainButton").remove(),$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED_AWAITING",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet)}}),$("#balanceRefreshButton").click(function(){$("#balanceRefreshIcon").addClass("loading"),$.getJSON("https://api.moneypot.com/v1/auth?access_token="+access_token,function(e){$("#balanceRefreshIcon").removeClass("loading"),$("#balance").text((e.user.balance/100).formatMoney(2,".",",")),user_balance=e.user.balance/100,addNewChatMessage({created_at:(new Date).toISOString(),text:"Balance refreshed! Amount: "+(e.user.balance/100).formatMoney(2,".",",")+" Bits"})})}),$("#viewMyBetsButton").click(function(){$("#game_mybets_log").css("display","block"),$("#game_allbets_log").css("display","none")}),$("#viewAllBetsButton").click(function(){$("#game_mybets_log").css("display","none"),$("#game_allbets_log").css("display","block");
}),$("#logoutButton").click(function(){"undefined"!=typeof $.session.get("session_access_token")&&$.session.remove("session_access_token"),window.location.href="/"});
